"use strict";var _createClass=function(){function s(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(t,i,e){return i&&s(t.prototype,i),e&&s(t,e),t}}();function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}var Gauge=function(){function t(){_classCallCheck(this,t),this.setDefaults()}return _createClass(t,[{key:"update",value:function(){if(void 0===this.debug||(this.toString(),!this.varsHasErrors())){var t=this.prepareVars();if(void 0!==this.tickModulus&&(this.drawTicks(t),this.drawTickBackground()),void 0!==this.background&&this.drawBackground(t),void 0===this.dataFillType){var i=t.data;void 0!==this.allowOverflow&&this.allowOverflow||i>this.maxValue&&(i=this.maxValue),void 0!==this.allowUnderflow&&this.allowUnderflow||i<this.minValue&&(i=this.minValue);for(var e=0;e<=Math.abs(i/this.tickSize);e++){var s=void 0,a=void 0;0<t.data?(s=(t.orientation-this.tickOffset+t.tick*e)*Math.PI/180,a=(t.orientation-this.tickOffset+t.tick*e+this.tickThickness)*Math.PI/180):(s=(t.orientation-this.tickOffset+t.tick*e*-1)*Math.PI/180,a=(t.orientation-this.tickOffset+t.tick*e*-1+this.tickThickness)*Math.PI/180),this.appendArc(s,a,t,e)}}else{var o=t.data;void 0!==this.allowOverflow&&this.allowOverflow||o>this.maxValue&&(o=this.maxValue),void 0!==this.allowUnderflow&&this.allowUnderflow||o<this.minValue&&(o=this.minValue);var h=Math.abs(o/this.tickSize),l=void 0,r=void 0;0<t.data?(l=(t.orientation-this.tickOffset+t.tick*h)*Math.PI/180,r=(t.orientation-this.tickOffset+t.tick*h+this.tickThickness)*Math.PI/180):(l=(t.orientation-this.tickOffset+t.tick*h*-1)*Math.PI/180,r=(t.orientation-this.tickOffset+t.tick*h*-1+this.tickThickness)*Math.PI/180),this.appendArc(l,r,t,h)}this.populateLabels()}}},{key:"appendArc",value:function(t,i,e,s,a){var o=d3.arc().innerRadius(e.thicknessBase-this.offset-e.thicknessBase*this.thickness/10).outerRadius(e.thicknessBase-this.offset).startAngle(t).endAngle(i);this.svg.append("path").attr("id","arc-"+a).attr("d",o).attr("transform","translate("+this.width/2+","+this.height/2+")").attr("fill",e.color)}},{key:"prepareVars",value:function(){var t=this.createRootElements(),i=.3*Math.min(this.width,this.height),e=this.maxDegrees/(this.maxValue/this.tickSize),s=this.data;this.data>this.maxValue?this.maxValue:this.data,s=this.data<this.minValue?this.minValue:this.data;var a=this.color;return this.data>this.maxValue?a=this.overflowColor:this.data<this.minValue&&(a=this.underflowColor),{element:t,thicknessBase:i,tick:e,data:s,color:a,orientation:this.orientation}}},{key:"createRootElements",value:function(){var t=d3.select("#"+this.rootElement);return t.node().innerHTML="",t.node().style.width=this.width+"px",t.node().style.height=this.height+"px",this.svg=t.append("svg").attr("id",this.rootElement+"-svg").attr("width",this.width).attr("height",this.height),t}},{key:"drawBackground",value:function(t){var i=t.orientation*Math.PI/180,e=void 0,s="full"===this.backgroundFill?360:this.maxDegrees;e=0<=this.data?(t.orientation+s)*Math.PI/180:(t.orientation-s)*Math.PI/180;var a=d3.arc().innerRadius(t.thicknessBase-this.offset-t.thicknessBase*this.thickness/10).outerRadius(t.thicknessBase-this.offset).startAngle(i).endAngle(e);this.svg.append("path").attr("d",a).attr("transform","translate("+this.width/2+","+this.height/2+")").attr("fill",this.background)}},{key:"drawTicks",value:function(t){Math.abs(this.maxDegrees),this.maxValue;for(var i=0;i<=this.maxValue;i++)if(i%this.tickModulus==0){var e=this.maxDegrees/this.maxValue*i;this.drawLine(e,1,0)}for(var s=0;s<=this.maxValue;s++)if(s%this.bigTickModulus==0){var a=this.maxDegrees/this.maxValue*s;this.drawLine(a,3,1),this.drawTickLabels(a,s+this.unit)}if(this.minValue<0){for(var o=this.minValue;o<=0;o++)if(o%this.tickModulus==0){var h=this.maxDegrees/this.maxValue*o;this.drawLine(h,1,0)}for(var l=this.minValue;l<=0;l++)if(l%this.bigTickModulus==0){var r=this.maxDegrees/this.maxValue*l;this.drawLine(r,3,1),this.drawTickLabels(r,l+this.unit)}}}},{key:"drawTickBackground",value:function(){var t=document.createElementNS("http://www.w3.org/2000/svg","circle");t.setAttribute("cx",0),t.setAttribute("cy",0),t.setAttribute("r",this.width/this.tickCoverRadius),t.setAttribute("fill",this.tickCoverColor),t.setAttribute("transform","translate("+this.width/2+","+this.height/2+")"),d3.select("#"+this.rootElement+"-svg").node().appendChild(t)}},{key:"drawLine",value:function(t,i,e){t*=-1;var s=this.width/(3-e/10),a=Math.cos((90-this.orientation+t)*Math.PI/180)*s,o=-1*Math.sin((90-this.orientation+t)*Math.PI/180)*s,h=document.createElementNS("http://www.w3.org/2000/svg","path");h.setAttribute("d","M0,0L"+a+","+o),h.setAttribute("stroke",this.tickColor),h.setAttribute("transform","translate("+this.width/2+","+this.height/2+")"),h.setAttribute("stroke-width",i),d3.select("#"+this.rootElement+"-svg").node().appendChild(h)}},{key:"drawTickLabels",value:function(t,i){t*=-1;var e=void 0,s=void 0,a=void 0;e=this.width/2.5+10,s=Math.cos((90-this.orientation+t)*Math.PI/180)*e,a=-1*Math.sin((90-this.orientation+t)*Math.PI/180)*e;var o=(this.width+this.width/100*-3)/2,h=(this.height+this.height/100*2)/2,l=document.createElementNS("http://www.w3.org/2000/svg","text");l.setAttribute("x",s),l.setAttribute("y",a),l.style.fontSize=this.tickLabelSize,l.setAttribute("transform","translate("+o+","+h+")"),l.style.fill=this.tickLabelColor,l.style.fontFamily=this.tickLabelFontFamily,l.textContent=i,Math.ceil(Math.abs(t))===this.maxDegrees&&(0<t?l.setAttribute("y",+l.getAttribute("y")+this.tickLabelSize):l.setAttribute("y",+l.getAttribute("y")+this.tickLabelSize/4*2*-1)),d3.select("#"+this.rootElement+"-svg").node().appendChild(l)}},{key:"populateLabels",value:function(){d3.select("#"+this.labelElement).text(this.data+this.unit)}},{key:"orientationVar",value:function(){return{NORTH:0,SOUTH:180,EAST:90,WEST:270}}},{key:"setDefaults",value:function(){this.width=400,this.height=400,this.thickness=3,this.tickSize=1,this.tickThickness=3,this.offset=0,this.orientation=this.orientationVar().NORTH,this.unit="",this.minValue=-50,this.maxValue=50,this.allowOverflow=!1,this.allowUnderflow=!0,this.maxDegrees=360,this.color="#aaa",this.overflowColor="#aaa",this.underflowColor="#aaa",this.showTickLabels=!1,this.background="rgba(0,0,0,0)",this.backgroundFill="maxDegrees",this.marginOffset=50,this.tickColor="#000",this.tickCoverColor="#fff",this.tickLabelSize="11px",this.tickLabelColor="#000",this.tickLabelFontFamily="monospace",this.tickOffset=1,this.tickCoverRadius=3.2}},{key:"setConfig",value:function(t){this.rootElement=void 0===t.rootElement?this.rootElement:t.rootElement,this.labelElement=void 0===t.labelElement?this.labelElement:t.labelElement,this.width=void 0===t.width?this.width:t.width,this.height=void 0===t.height?this.height:t.height,this.thickness=void 0===t.thickness?this.thickness:t.thickness,this.tickSize=void 0===t.tickSize?this.tickSize:t.tickSize,this.tickThickness=void 0===t.tickThickness?this.tickThickness:t.tickThickness,this.offset=void 0===t.offset?this.offset:t.offset,this.orientation=void 0===t.orientation?this.orientation:t.orientation,this.unit=void 0===t.unit?this.unit:t.unit,this.minValue=void 0===t.minValue?this.minValue:t.minValue,this.maxValue=void 0===t.maxValue?this.maxValue:t.maxValue,this.allowOverflow=void 0===t.allowOverflow?this.allowOverflow:t.allowOverflow,this.allowUnderflow=void 0===t.allowUnderflow?this.allowUnderflow:t.allowUnderflow,this.maxDegrees=void 0===t.maxDegrees?this.maxDegrees:t.maxDegrees,this.data=void 0===t.data?this.data:t.data,this.color=void 0===t.color?this.color:t.color,this.overflowColor=void 0===t.overflowColor?this.color:t.overflowColor,this.underflowColor=void 0===t.underflowColor?this.color:t.underflowColor,this.showTickLabels=void 0===t.showTickLabels?this.showTickLabels:t.showTickLabels,this.tickModulus=void 0===t.tickModulus?this.tickModulus:t.tickModulus,this.bigTickModulus=void 0===t.bigTickModulus?this.bigTickModulus:t.bigTickModulus,this.background=void 0===t.background?this.background:t.background,this.backgroundFill=void 0===t.backgroundFill?this.backgroundFill:t.backgroundFill,this.tickColor=void 0===t.tickColor?this.tickColor:t.tickColor,this.tickCoverColor=void 0===t.tickCoverColor?this.tickCoverColor:t.tickCoverColor,this.tickLabelColor=void 0===t.tickLabelColor?this.tickLabelColor:t.tickLabelColor,this.tickLabelSize=void 0===t.tickLabelSize?this.tickLabelSize:t.tickLabelSize,this.tickLabelFontFamily=void 0===t.tickLabelFontFamily?this.tickLabelFontFamily:t.tickLabelFontFamily,this.tickOffset=void 0===t.tickOffset?this.tickOffset:t.tickOffset,this.tickCoverRadius=void 0===t.tickCoverRadius?this.tickCoverRadius:t.tickCoverRadius,this.dataFillType=void 0===t.dataFillType?this.dataFillType:t.dataFillType}}]),t}();